!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["angular"],b):"object"==typeof exports?module.exports=b(require("angular")):b(a.angular)}(this,function(a){"use strict";function b(b){return function(){var c="ngStorage-";this.setKeyPrefix=function(a){if("string"!=typeof a)throw new TypeError("[ngStorage] - "+b+"Provider.setKeyPrefix() expects a String.");c=a},this.$get=["$rootScope","$window","$log","$timeout",function(d,e,f,g){function h(a){var b;try{b=e[a]}catch(a){b=!1}if(b&&"localStorage"===a){var c="__"+Math.round(1e7*Math.random());try{localStorage.setItem(c,c),localStorage.removeItem(c)}catch(a){b=!1}}return b}var k,l,i=h(b)||(f.warn("This browser does not support Web Storage!"),{setItem:a.noop,getItem:a.noop}),j={$default:function(b){for(var c in b)a.isDefined(j[c])||(j[c]=b[c]);return j.$sync(),j},$reset:function(a){for(var b in j)"$"===b[0]||delete j[b]&&i.removeItem(c+b);return j.$default(a)},$sync:function(){for(var e,b=0,d=i.length;b<d;b++)(e=i.key(b))&&c===e.slice(0,10)&&(j[e.slice(10)]=a.fromJson(i.getItem(e)))}};return j.$sync(),k=a.copy(j),d.$watch(function(){var b;l||(l=g(function(){if(l=null,!a.equals(j,k)){b=a.copy(k),a.forEach(j,function(d,e){a.isDefined(d)&&"$"!==e[0]&&i.setItem(c+e,a.toJson(d)),delete b[e]});for(var d in b)i.removeItem(c+d);k=a.copy(j)}},100,!1))}),e.addEventListener&&e.addEventListener("storage",function(b){c===b.key.slice(0,10)&&(b.newValue?j[b.key.slice(10)]=a.fromJson(b.newValue):delete j[b.key.slice(10)],k=a.copy(j),d.$apply())}),j}]}}return a=a||window.angular,a.module("ngStorage",[]).provider("$localStorage",b("localStorage")).provider("$sessionStorage",b("sessionStorage"))});